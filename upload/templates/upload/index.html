{% load staticfiles %}
<html>
  <head>
    <link rel="stylesheet" href="{% static 'css/NotePageStyle.css' %}">
    <title>NotePlatForm</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.0/dist/semantic.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.0/dist/semantic.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script>
      $(document).ready(function(){

          $('.like').click(function(){
            //var fav=document.getElementById("like_{{note.idnote}}");
            console.log("Click")
            var noteid = $(this).attr("id")
            var text = ".like#"+noteid+" .liketext"
            var btn = ".like#"+noteid
            $.ajax({
              url: '/upload/addLike/',
              type: "POST",
              data: {"id": noteid },
              dataType: 'json',
              success: function(data) {
                if (data==1){

                  console.log(text)
                  $(text).text("已收藏")
                  $(btn).removeClass("Basic")
                  $(btn).addClass("Blue")
                  alert("success!");
                }
                else {
                  console.log(data + "remove")
                  $(text).text("收藏")
                  $(btn).removeClass("Blue")
                  $(btn).addClass("Basic")
                }
              }
            });
          });
        })
    </script>
    <style type="text/css">
       .note:hover{
        top: -5px;
       }
    </style>

  </head>
  <h2>Note Page</h2>
  <button onclick="location.href='../create/'" type="button">Create New Note</button>

<div class="notePage ui grid container">
    {% for note in note %}
      <div class="four wide column">
        <div class="note ui card" style="cursor:pointer;">
            <div class="content">
              <script>
                var imgName = "{{note.user.first_name}}";
                if (imgName == ""){
                  document.write('<img class="ui avatar image" src="https://semantic-ui.com/images/avatar/large/elliot.jpg">');
                }
                else{
                  document.write('<img class="ui avatar image" src="http://127.0.0.1:8000/media/{{note.user.first_name}}">');
                }
              </script>

                {{note.user.username}}

                <div class="right floated meta">14h</div>
            </div>
            <div class="content">
                <h3 class="center aligned">{{note.title}}</h3>

                <h5 class="center aligned">{{ note.intro }}</h5>
            </div>
            <div class="content">
              <div class="list">
                <div class = "item">
                  {{note.field}}
                </div>
                <div clas="item">
                  {{note.subjects}}</div>
              </div>
            </div>
            <div class="content">
                {%if note.idnote in fav %}
                <button class="ui right labeled icon button Mini Blue left floated like" id='{{note.idnote}}'>
                    <i class="bookmark icon"></i><span class="liketext">已收藏</span>
                </button>
                {% else %}
                <button class="ui right labeled icon button Mini Basic left floated like" id='{{note.idnote}}'>
                    <i class="bookmark icon"></i><span class="liketext">收藏</span>
                </button>
                {% endif %}
              <!--  <input id="like" type='submit' value="add Like" onclick="style">-->
              <div class="right floated">
                {%ifequal note.permission 1  %}
                  <i class="globe icon"></i>公開
                {% else %}
                  <i class="user icon"></i>私人
                {% endifequal %}
              </div>
            </div>
        <!--    <script>
              $(document).ready(function(){

                  $('#like_{{note.idnote}}').click(function(){
                    //var fav=document.getElementById("like_{{note.idnote}}");
                    $.ajax({
                      url: '/upload/addLike/{{ note.idnote }}/',
                      success: function(data) {
                        if (data==1){
                          alert("success!");
                        }
                        else {
                          //$("#like_{{note.idnote}}").addClass("red");
                          alert("already exist & remove it");
                        }
                      }
                    });
                  });
                })
            </script> -->
        </div>
      </div>

    {% endfor %}

</div>

</html>
